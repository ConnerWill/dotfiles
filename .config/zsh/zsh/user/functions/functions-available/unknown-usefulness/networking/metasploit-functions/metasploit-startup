###
### METASPLOIT STARTUP HELPER
###
function metasploit(){

  local msfconsole_modules_dir="/opt/metasploit"
  local msfconsole_session_logs_dir="$HOME/security/exploit/metasploit/metasploit-logs"
  local msfconsole_session_logs_path="$msfconsole_session_logs_dir/$(date +'%YYYY%m%d-%H%M')-metasploit-session.log"
  local msfconsole_session_history_dir="HOME/security/exploit/metasploit/metasploit-history"
  local msfconsole_session_history_path="$msfconsole_session_history_dir/metasploit-history/$(date +'%YYYY%m%d-%H%M')-metasploit-history.log"

  # Confirm Output Dir Exists
  [[ ! -d "$msfconsole_session_logs_dir" ]] \
    && mkdir -p "$msfconsole_session_logs_dir" \
      || echo "Cannot Create Output Directory:\t$msfconsole_session_logs_dir"

  # Confirm History Dir Exists
  [[ ! -d "$msfconsole_session_history_dir" ]] \
    && mkdir -p "$msfconsole_session_history_dir" \
      || echo "Cannot Create Output Directory:\t$msfconsole_session_history_dir"

  # Move to the directory containing msf modules
  [[ ! -d "$msfconsole_modules_dir"]] \
    && echo "Cannot find msf modules directory:\t$msfconsole_modules_dir"

  # Start msf database
  msfd \
    || echo "There was an error starting msfdb ..." 

  # Start METASPLOIT
  msfconsole \
    --history-file "$msfconsole_session_history_path" \
      --output "$msfconsole_session_logs_path" \
        --ask
}
